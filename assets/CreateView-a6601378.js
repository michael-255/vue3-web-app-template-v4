import{q as S,N as k,G as x,t as A,O as h,r as B,ac as R,a0 as u,aq as $,x as q,y as s,z as C,A as m,u as e,S as p,B as o,C as N,Q as V,I as c,L as Q,X as T,U as F,T as L,E as i,J as j,Y as z,Z as G,ar as M,D as U,as as W}from"./index-ef11a4d2.js";import{_ as J,Q as O}from"./ParentInfoCard.vue_vue_type_script_setup_true_lang-002aff9b.js";import{_ as X}from"./ResponsivePage.vue_vue_type_script_setup_true_lang-17ea769c.js";import{u as Y}from"./useRoutables-81d4533e.js";import{u as Z}from"./action-ee52ff77.js";import{u as H}from"./useDialogs-c3fdb6eb.js";import"./QSelect-f9ed5694.js";import"./QItem-bdaee51e.js";import"./QItemLabel-6937233e.js";import"./QMenu-17d8d43f.js";import"./selection-0dee77d8.js";import"./ui-29eb266c.js";const K={key:0},P=i("span",{class:"q-ml-md"},"Error rendering this record",-1),ee={key:1},ae={class:"row justify-center q-my-sm"},re={class:"row justify-center"},te=i("span",{class:"text-caption q-ml-xs text-warning"}," Correct invalid entries and try again ",-1),ye=S({__name:"CreateView",setup(se){k({title:`${x} - Create Record`});const{routeGroup:f,routeType:n,routeCoreId:v,goBack:w}=Y(),{log:_}=A(),{confirmDialog:I}=H(),a=Z(),g=h.getLabel(f,n,"singular"),b=h.getFieldProps(f,n),y=B(!0);R(async()=>{try{a.record[u.Values.id]=$(),a.record[u.Values.type]=n,v&&(a.record[u.Values.coreId]=v)}catch(r){_.error("Error loading create view",r)}}),q(()=>{a.$reset()});async function D(){I("Create",`Create ${g} record?`,c.CREATE,"positive",async()=>{try{const r=M(!0,{},a.record);await U.addRecord(f,n,r),_.info("Successfully created record",{id:r[u.Values.id],type:n}),w()}catch(r){_.error("Create failed",r)}})}return(r,l)=>(s(),C(X,{bannerIcon:e(c).CREATE,bannerTitle:`Create ${e(g)}`},{default:m(()=>[!e(g)||!e(b)?(s(),p("div",K,[o(Q,{class:"q-mb-md"},{default:m(()=>[o(N,null,{default:m(()=>[o(V,{name:e(c).WARN,size:"md",color:"warning"},null,8,["name"]),P]),_:1})]),_:1})])):(s(),p("div",ee,[o(O,{onSubmit:D,onValidationError:l[0]||(l[0]=d=>y.value=!1),onValidationSuccess:l[1]||(l[1]=d=>y.value=!0)},{default:m(()=>{var d;return[(d=e(a).record)!=null&&d.coreId?(s(),C(J,{key:0,coreId:e(a).record.coreId},null,8,["coreId"])):T("",!0),(s(!0),p(F,null,L(e(b),(t,E)=>(s(),p("div",{key:E,class:"q-mb-md"},[(s(),C(W(t.component),{field:t.field,label:t.label,desc:t.desc,getDefault:t.getDefault,schema:t.schema,message:t.message},null,8,["field","label","desc","getDefault","schema","message"]))]))),128)),i("div",ae,[o(j,{label:"Create",type:"submit",color:"positive",icon:e(c).SAVE},null,8,["icon"])]),i("div",re,[z(i("div",null,[o(V,{name:e(c).WARN,color:"warning"},null,8,["name"]),te],512),[[G,!y.value]])])]}),_:1})]))]),_:1},8,["bannerIcon","bannerTitle"]))}});export{ye as default};
