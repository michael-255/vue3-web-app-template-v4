import{Q as D,a as k,b as _,c as F}from"./QTable-89773ff3.js";import{d as O,b as R,A as j,e as U,r as d,J as C,D as T,f as x,h as G,j as m,k as w,l as t,m as o,q as E,s as P,F as S,G as p,x as u,u as e,I as i,n as v,t as f,Q as q,K as H,v as J,C as K,E as z,M as W}from"./index-5d245f77.js";import{Q as X}from"./QSelect-65e68149.js";import{u as Y}from"./useRoutables-128af855.js";import{u as Z}from"./useDialogs-7677fd0b.js";import"./QList-3c4dfd94.js";import"./QItem-6c91178d.js";import"./QItemLabel-35dc4d65.js";import"./QMenu-36ba3952.js";import"./selection-280b5155.js";import"./SimpleDialog.vue_vue_type_script_setup_true_lang-9013e5dc.js";const ee={class:"row justify-start full-width q-mb-md"},le={class:"col-10 text-h6 text-bold ellipsis"},oe={class:"row justify-start full-width"},te={class:"col-12"},be=O({__name:"DataParentView",setup(ae){R({title:`${j} - Records Data`});const{log:b}=U(),{routeType:r,goToCharts:Q,goToParentInspect:I,goToParentEdit:V,goToParentCreate:$,goBack:N}=Y(),{confirmDialog:A}=Z(),g=d(""),c=d([]),h=d([C.ID,C.TIMESTAMP,C.NAME]),y=d(T.getParentTableColumns(r)),B=d(y.value.filter(a=>!a.required)),L=x.liveParents(r).subscribe({next:a=>{c.value=a},error:a=>{b.error("Error fetching live parent records",a)}});G(()=>{L.unsubscribe()});async function M(a){let s=`Permanently delete ${T.getParentLabelSingular(r)} with id ${a}? This will also delete accompanying child records.`;A("Delete",s,i.DELETE,"negative",async()=>{try{await x.deleteParent(a),b.info("Successfully deleted record",{type:r,id:a})}catch(l){b.error("Delete failed",l)}})}return(a,s)=>(m(),w(F,{rows:c.value,columns:y.value,"visible-columns":h.value,"rows-per-page-options":[0],filter:g.value,"virtual-scroll":"",fullscreen:"","row-key":"id"},{header:t(l=>[o(k,{props:l},{default:t(()=>[(m(!0),E(S,null,P(l.cols,n=>K((m(),w(D,{key:n.name,props:l},{default:t(()=>[p(f(n.label),1)]),_:2},1032,["props"])),[[z,!e(W).includes(n.name)]])),128)),o(D,{"auto-width":"",class:"text-left"},{default:t(()=>[p("Actions")]),_:1})]),_:2},1032,["props"])]),body:t(l=>[o(k,{props:l},{default:t(()=>[(m(!0),E(S,null,P(l.cols,n=>(m(),w(_,{key:n.name,props:l},{default:t(()=>[p(f(n.value),1)]),_:2},1032,["props"]))),128)),o(_,{"auto-width":""},{default:t(()=>[o(u,{flat:"",round:"",dense:"",class:"q-ml-xs",color:"accent",icon:e(i).CHARTS,onClick:n=>e(Q)(e(r),l.cols[0].value)},null,8,["icon","onClick"]),o(u,{flat:"",round:"",dense:"",class:"q-ml-xs",color:"primary",icon:e(i).INSPECT,onClick:n=>e(I)(e(r),l.cols[0].value)},null,8,["icon","onClick"]),o(u,{flat:"",round:"",dense:"",class:"q-ml-xs",color:"orange-9",icon:e(i).EDIT,onClick:n=>e(V)(e(r),l.cols[0].value)},null,8,["icon","onClick"]),o(u,{flat:"",round:"",dense:"",class:"q-ml-xs",color:"negative",onClick:n=>M(l.cols[0].value),icon:e(i).DELETE},null,8,["onClick","icon"])]),_:2},1024)]),_:2},1032,["props"])]),top:t(()=>[v("div",ee,[v("div",le,f(e(T).getParentLabelPlural(e(r))),1),o(u,{round:"",flat:"",class:"absolute-top-right q-mr-sm q-mt-sm",icon:e(i).CLOSE,onClick:s[0]||(s[0]=l=>e(N)())},null,8,["icon"])]),v("div",oe,[v("div",te,[o(H,{disable:!c.value.length,outlined:"",dense:"",clearable:"",debounce:"300",modelValue:g.value,"onUpdate:modelValue":s[3]||(s[3]=l=>g.value=l),placeholder:"Search"},{before:t(()=>[o(u,{color:"positive",class:"q-px-sm q-mr-xs",icon:e(i).ADD,onClick:s[1]||(s[1]=l=>e($)(e(r)))},null,8,["icon"]),o(X,{modelValue:h.value,"onUpdate:modelValue":s[2]||(s[2]=l=>h.value=l),options:B.value,disable:!c.value.length,"bg-color":"primary",standout:"",multiple:"",dense:"","options-dense":"","emit-value":"","map-options":"","option-value":"name","display-value":""},{prepend:t(()=>[o(q,{color:"white",name:e(i).OPTIONS},null,8,["name"])]),_:1},8,["modelValue","options","disable"])]),append:t(()=>[o(q,{name:"search"})]),_:1},8,["disable","modelValue"])])])]),bottom:t(()=>[p(f(e(J)(c.value)),1)]),_:1},8,["rows","columns","visible-columns","filter"]))}});export{be as default};
