import{k as A,U as x,A as E,F as R,D as i,r as $,l as h,Y as B,m as r,n as c,w as v,x as e,G as l,M as D,L as V,p as f,I as a,z as g,H as S,J as F,t as y,Q as I,al as L,am as Q,an as T}from"./index-02241220.js";import{Q as q}from"./QForm-d61daaa5.js";import{_ as N}from"./ErrorStates.vue_vue_type_script_setup_true_lang-36d9d8e8.js";import{_ as j}from"./ResponsivePage.vue_vue_type_script_setup_true_lang-36da4c7a.js";import{u as M}from"./action-1184df79.js";import{u as U}from"./useDialogs-e9a47623.js";import{u as z}from"./useRouting-4a9c9893.js";import"./QSelect-ed53d23a.js";import"./QItem-7d08a2ad.js";import"./QItemLabel-835fe105.js";import"./QMenu-a2da2bd7.js";import"./selection-b942f17b.js";import"./ui-96d61f06.js";const G={key:0,class:"row justify-center q-my-sm"},H={key:1,class:"row justify-center q-my-sm"},J={class:"row justify-center"},K=y("span",{class:"text-caption q-ml-xs text-warning"}," Correct invalid entries and try again ",-1),ce=A({__name:"CreateView",setup(O){x({title:`${E} - Create Record`});const{routeTable:o,goBack:C}=z(),{log:d}=R(),{confirmDialog:b}=U(),t=M(),m=i.getLabel(o,"singular"),_=i.getFieldComponents(o),u=$(!0);h(async()=>{try{t.table=o,t.record=i.getDefaultActionRecord(o)}catch(n){d.error("Error loading create view",n)}}),B(()=>{t.$reset()});async function w(){b("Create",`Create ${m} record?`,a.CREATE,"positive",async()=>{try{t.record.id=L(),t.record.activated=!1,await i.addRecord(o,Q(!0,{},t.record)),d.info("Record created",{table:o,id:t.record.id}),C()}catch(n){d.error("Create failed",n)}})}return(n,s)=>(r(),c(j,{bannerIcon:e(a).CREATE,bannerTitle:`Create ${e(m)}`},{default:v(()=>[e(m)&&e(_).length>0?(r(),c(q,{key:0,onSubmit:w,onValidationError:s[0]||(s[0]=p=>u.value=!1),onValidationSuccess:s[1]||(s[1]=p=>u.value=!0)},{default:v(()=>[(r(!0),l(V,null,D(e(_),(p,k)=>(r(),l("div",{key:k,class:"q-mb-md"},[(r(),c(T(p)))]))),128)),e(t).record.activated?(r(),l("div",H,[f(g,{disable:"",label:"Active",color:"warning",icon:e(a).LOCK},null,8,["icon"])])):(r(),l("div",G,[f(g,{label:"Create",type:"submit",color:"positive",icon:e(a).SAVE},null,8,["icon"])])),S(y("div",J,[f(I,{name:e(a).WARN,color:"warning"},null,8,["name"]),K],512),[[F,!u.value]])]),_:1})):(r(),c(N,{key:1,error:"unknown"}))]),_:1},8,["bannerIcon","bannerTitle"]))}});export{ce as default};
