import{l as d,r as q,b1 as W,ag as G,b2 as X,b3 as J,ad as Y,b4 as Z,d as ee,a as te,f as x,h as ae,w as u,j as r,Q as ne,p as I,x as T,q as A,i as N,n as R,t as g,I as v,v as P,B as oe,K as b,aw as re,b5 as ie,b6 as le,m as se,D as k,c as j}from"./index-85cdcb14.js";import{Q as C,a as E}from"./QItemSection-376d8637.js";import{Q as ue}from"./QList-df3f4761.js";import{Q as ce}from"./QMenu-91b59cc6.js";import{Q as fe}from"./QBadge-5bc5a049.js";import{u as de}from"./useDialogs-bd0c25a5.js";import{u as me}from"./useRoutables-c00f81b4.js";function V(e){return X()?(J(e),!0):!1}function Q(e){return typeof e=="function"?e():d(e)}const _=typeof window<"u";function ve(e,t=1e3,a={}){const{immediate:n=!0,immediateCallback:i=!1}=a;let s=null;const c=q(!1);function m(){s&&(clearInterval(s),s=null)}function D(){c.value=!1,m()}function w(){const $=Q(t);$<=0||(c.value=!0,i&&e(),m(),s=setInterval(e,$))}if(n&&_&&w(),W(t)||typeof t=="function"){const $=G(t,()=>{c.value&&_&&w()});V($)}return V(D),{isActive:c,pause:D,resume:w}}const pe=_?window:void 0;function ye(e,t={}){const{immediate:a=!0,window:n=pe}=t,i=q(!1);let s=0,c=null;function m($){if(!i.value||!n)return;const l=$-s;e({delta:l,timestamp:$}),s=$,c=n.requestAnimationFrame(m)}function D(){!i.value&&n&&(i.value=!0,c=n.requestAnimationFrame(m))}function w(){i.value=!1,c!=null&&n&&(n.cancelAnimationFrame(c),c=null)}return a&&D(),V(w),{isActive:Z(i),pause:w,resume:D}}var we=Object.defineProperty,B=Object.getOwnPropertySymbols,$e=Object.prototype.hasOwnProperty,ge=Object.prototype.propertyIsEnumerable,M=(e,t,a)=>t in e?we(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,De=(e,t)=>{for(var a in t||(t={}))$e.call(t,a)&&M(e,a,t[a]);if(B)for(var a of B(t))ge.call(t,a)&&M(e,a,t[a]);return e};function Ee(e={}){const{controls:t=!1,interval:a="requestAnimationFrame"}=e,n=q(new Date),i=()=>n.value=new Date,s=a==="requestAnimationFrame"?ye(i,{immediate:!0}):ve(i,a,{immediate:!0});return t?De({now:n},s):n}var he=Object.defineProperty,S=Object.getOwnPropertySymbols,z=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable,U=(e,t,a)=>t in e?he(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,Ie=(e,t)=>{for(var a in t||(t={}))z.call(t,a)&&U(e,a,t[a]);if(S)for(var a of S(t))H.call(t,a)&&U(e,a,t[a]);return e},Oe=(e,t)=>{var a={};for(var n in e)z.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(e!=null&&S)for(var n of S(e))t.indexOf(n)<0&&H.call(e,n)&&(a[n]=e[n]);return a};const Te=[{max:6e4,value:1e3,name:"second"},{max:276e4,value:6e4,name:"minute"},{max:72e6,value:36e5,name:"hour"},{max:5184e5,value:864e5,name:"day"},{max:24192e5,value:6048e5,name:"week"},{max:28512e6,value:2592e6,name:"month"},{max:1/0,value:31536e6,name:"year"}],Fe={justNow:"just now",past:e=>e.match(/\d/)?`${e} ago`:e,future:e=>e.match(/\d/)?`in ${e}`:e,month:(e,t)=>e===1?t?"last month":"next month":`${e} month${e>1?"s":""}`,year:(e,t)=>e===1?t?"last year":"next year":`${e} year${e>1?"s":""}`,day:(e,t)=>e===1?t?"yesterday":"tomorrow":`${e} day${e>1?"s":""}`,week:(e,t)=>e===1?t?"last week":"next week":`${e} week${e>1?"s":""}`,hour:e=>`${e} hour${e>1?"s":""}`,minute:e=>`${e} minute${e>1?"s":""}`,second:e=>`${e} second${e>1?"s":""}`,invalid:""};function xe(e){return e.toISOString().slice(0,10)}function be(e,t={}){const{controls:a=!1,updateInterval:n=3e4}=t,i=Ee({interval:n,controls:!0}),{now:s}=i,c=Oe(i,["now"]),m=Y(()=>Ce(new Date(Q(e)),t,Q(s.value)));return a?Ie({timeAgo:m},c):m}function Ce(e,t={},a=Date.now()){var n;const{max:i,messages:s=Fe,fullDateFormatter:c=xe,units:m=Te,showSecond:D=!1,rounding:w="round"}=t,$=typeof w=="number"?p=>+p.toFixed(w):Math[w],l=+a-+e,o=Math.abs(l);function f(p,y){return $(Math.abs(p)/y.value)}function O(p,y){const F=f(p,y),h=p>0,K=L(y.name,F,h);return L(h?"past":"future",K,h)}function L(p,y,F){const h=s[p];return typeof h=="function"?h(y,F):h.replace("{0}",y.toString())}if(o<6e4&&!D)return s.justNow;if(typeof i=="number"&&o>i)return c(new Date(e));if(typeof i=="string"){const p=(n=m.find(y=>y.name===i))==null?void 0:n.max;if(p&&o>p)return c(new Date(e))}for(const[p,y]of m.entries()){if(f(l,y)<=0&&m[p-1])return O(l,m[p-1]);if(o<y.max)return O(l,y)}return s.invalid}const Se={class:"text-h6 q-mb-md"},Ae={key:0,class:"q-mb-md"},Ne={class:"absolute-top-right q-ma-xs"},Re={class:"q-mb-md"},Pe={class:"text-caption q-ml-xs"},ke={key:0},Ve={class:"text-caption q-ml-xs"},Qe={key:1},_e={class:"text-caption q-ml-xs"},He=ee({__name:"DashboardParentCard",props:{type:null,id:null,name:null,showDescription:null,description:null,isFavorited:{type:Boolean},previousNote:null,previousCreatedTimestamp:null,previousNumber:null},setup(e){const{log:t}=te(),{goToInspect:a,goToEdit:n,goToCharts:i}=me(),{confirmDialog:s,dismissDialog:c}=de();async function m(l){c("Previous Note",l,v.NOTE,"info")}async function D(l,o,f){s("Favorite",`Do you want to favorite ${f}?`,v.FAVORITE_ON,"info",async()=>{try{await k.updateRecord(l,o,{[j.IS_FAVORITED]:!0}),t.info(`${f} favorited`,{favoritedRecordType:l,favoritedRecordId:o})}catch(O){t.error("Favorite update failed",O)}})}async function w(l,o,f){s("Unfavorite",`Do you want to unfavorite ${f}?`,v.FAVORITE_OFF,"info",async()=>{try{await k.updateRecord(l,o,{[j.IS_FAVORITED]:!1}),t.info(`${f} unfavorited`,{unfavoritedRecordType:l,unfavoritedRecordId:o})}catch(O){t.error("Unfavorite update failed",O)}})}async function $(l,o){s("Delete Record",`Permanently delete record ${o} from ${l}?`,v.DELETE,"negative",async()=>{try{await k.deleteRecord(l,o),t.info("Successfully deleted record",{deletedRecordType:l,deletedRecordId:o})}catch(f){t.error("Delete failed",f)}})}return(l,o)=>(x(),ae(se,null,{default:u(()=>[r(ne,null,{default:u(()=>[I("div",Se,T(e.name),1),e.showDescription?(x(),A("div",Ae,T(e.description),1)):N("",!0),I("div",Ne,[R(r(g,{name:d(v).NOTE,color:"primary",size:"md",class:"cursor-pointer q-mr-xs",onClick:o[0]||(o[0]=f=>m(e.previousNote||""))},null,8,["name"]),[[P,e.previousNote]]),R(r(g,{name:d(v).FAVORITE_ON,color:"warning",size:"md",class:"cursor-pointer",onClick:o[1]||(o[1]=f=>w(e.type,e.id,e.name))},null,8,["name"]),[[P,e.isFavorited]]),R(r(g,{name:d(v).FAVORITE_OFF,color:"grey",size:"md",class:"cursor-pointer",onClick:o[2]||(o[2]=f=>D(e.type,e.id,e.name))},null,8,["name"]),[[P,!e.isFavorited]]),r(oe,{round:"",flat:"",icon:d(v).MENU_VERTICAL},{default:u(()=>[r(ce,{"auto-close":"",anchor:"top right","transition-show":"flip-right","transition-hide":"flip-left"},{default:u(()=>[r(ue,null,{default:u(()=>[r(C,{clickable:"",onClick:o[3]||(o[3]=f=>d(a)(e.type,e.id))},{default:u(()=>[r(E,{avatar:""},{default:u(()=>[r(g,{color:"primary",name:d(v).INSPECT},null,8,["name"])]),_:1}),r(E,null,{default:u(()=>[b("Inspect")]),_:1})]),_:1}),r(C,{clickable:"",onClick:o[4]||(o[4]=f=>d(n)(e.type,e.id))},{default:u(()=>[r(E,{avatar:""},{default:u(()=>[r(g,{color:"primary",name:d(v).EDIT},null,8,["name"])]),_:1}),r(E,null,{default:u(()=>[b("Edit")]),_:1})]),_:1}),r(C,{clickable:"",onClick:o[5]||(o[5]=f=>d(i)(e.type,e.id))},{default:u(()=>[r(E,{avatar:""},{default:u(()=>[r(g,{color:"primary",name:d(v).CHARTS},null,8,["name"])]),_:1}),r(E,null,{default:u(()=>[b("Charts")]),_:1})]),_:1}),r(re),r(C,{clickable:"",onClick:o[6]||(o[6]=f=>$(e.type,e.id))},{default:u(()=>[r(E,{avatar:""},{default:u(()=>[r(g,{color:"negative",name:d(v).DELETE},null,8,["name"])]),_:1}),r(E,null,{default:u(()=>[b("Delete")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["icon"])]),I("div",Re,[r(fe,{rounded:"",color:"secondary",class:"q-py-none"},{default:u(()=>[r(g,{name:d(v).PREVIOUS},null,8,["name"]),I("span",Pe,T(d(be)(e.previousCreatedTimestamp||"").value||"No previous records"),1)]),_:1}),e.previousCreatedTimestamp?(x(),A("div",ke,[r(g,{name:d(v).CALENDAR_CHECK},null,8,["name"]),I("span",Ve,T(d(ie)(e.previousCreatedTimestamp)),1)])):N("",!0),e.previousNumber!==void 0&&e.previousNumber!==null?(x(),A("div",Qe,[r(g,{name:d(v).EXAMPLES},null,8,["name"]),I("span",_e,T(e.previousNumber),1)])):N("",!0)]),I("div",null,[le(l.$slots,"default")])]),_:3})]),_:3}))}});export{He as _};
