import{u as O,Q as D,a as _,b as P,c as $}from"./useActions-805fa00e.js";import{d as U,u as F,A as j,a as L,r as c,c as s,D as C,g as K,a5 as H,e as M,a6 as p,a7 as z,o as G,f as d,h,w as o,j as t,q as R,s as k,F as N,K as v,B as f,l as r,I as m,p as g,t as q,N as J,x as E,y as W,a8 as X,a9 as Z,aa as ee,ab as se,n as ae,v as oe}from"./index-85cdcb14.js";import{Q as le}from"./QSelect-67a98a6d.js";import{u as te}from"./useRoutables-c00f81b4.js";import"./QList-df3f4761.js";import"./useDialogs-bd0c25a5.js";import"./SimpleDialog.vue_vue_type_script_setup_true_lang-7796c2c3.js";import"./QItemSection-376d8637.js";import"./QItemLabel-210f03e5.js";import"./QMenu-91b59cc6.js";import"./selection-fec6dfc1.js";const ne={class:"row justify-start full-width q-mb-md"},re=g("div",{class:"col-10 text-h6 ellipsis"},"Record Curing",-1),ie={class:"row justify-start full-width"},ue={class:"col-12"},he=U({__name:"RecordCuringView",setup(ce){F({title:`${j} - Record Curing`});const{log:x}=L(),{goToInspect:Y,goToEdit:B,goBack:Q}=te(),{onDeleteRecord:V}=O(),w=c([X,Z,ee,se,{name:"recordIssue",label:"Record Issue",align:"left",sortable:!0,required:!1,field:n=>n.recordIssue,format:n=>`${n}`}]),A=c(w.value.filter(n=>!n.required)),T=c([s.TYPE,s.ID,"recordIssue"]),u=c([]),I=c(""),S=C.liveRecordCuring().subscribe({next:async n=>{const i=K(),e=H(),l=await Promise.all(n.map(async a=>{if(i.includes(a[s.TYPE])){const b=M(a[s.TYPE])??!1;if(b){const y=await C.getChildRecordsByParentId(b,a[s.ID]);if((y==null?void 0:y.length)===0)return{[s.TYPE]:a[s.TYPE],[s.ID]:a[s.ID],recordIssue:p.UNUSED}}}return e.includes(a[s.TYPE])&&!await C.getRecord(z(a[s.TYPE]),a[s.PARENT_ID])?{[s.TYPE]:a[s.TYPE],[s.ID]:a[s.ID],recordIssue:p.ORPHANED}:{[s.TYPE]:a[s.TYPE],[s.ID]:a[s.ID],recordIssue:p.NONE}}));u.value=l.filter(a=>a.recordIssue!==p.NONE)},error:n=>{x.error("Error during data retrieval",n)}});return G(()=>{S.unsubscribe()}),(n,i)=>(d(),h($,{rows:u.value,columns:w.value,"visible-columns":T.value,"rows-per-page-options":[0],filter:I.value,"virtual-scroll":"",fullscreen:"","row-key":"id"},{header:o(e=>[t(_,{props:e},{default:o(()=>[(d(!0),R(N,null,k(e.cols,l=>ae((d(),h(D,{key:l.name,props:e},{default:o(()=>[v(E(l.label),1)]),_:2},1032,["props"])),[[oe,l.name!=="hiddenType"&&l.name!=="hiddenId"]])),128)),t(D,{"auto-width":"",class:"text-left"},{default:o(()=>[v("Actions")]),_:1})]),_:2},1032,["props"])]),body:o(e=>[t(_,{props:e},{default:o(()=>[(d(!0),R(N,null,k(e.cols,l=>(d(),h(P,{key:l.name,props:e},{default:o(()=>[v(E(l.value),1)]),_:2},1032,["props"]))),128)),t(P,{"auto-width":""},{default:o(()=>[t(f,{flat:"",round:"",dense:"",class:"q-ml-xs",color:"primary",icon:r(m).INSPECT,onClick:l=>r(Y)(e.cols[0].value,e.cols[1].value)},null,8,["icon","onClick"]),t(f,{flat:"",round:"",dense:"",class:"q-ml-xs",color:"orange-9",icon:r(m).EDIT,onClick:l=>r(B)(e.cols[0].value,e.cols[1].value)},null,8,["icon","onClick"]),t(f,{flat:"",round:"",dense:"",class:"q-ml-xs",color:"negative",onClick:l=>r(V)(e.cols[0].value,e.cols[1].value),icon:r(m).DELETE},null,8,["onClick","icon"])]),_:2},1024)]),_:2},1032,["props"])]),top:o(()=>[g("div",ne,[re,t(f,{round:"",flat:"",class:"absolute-top-right q-mr-sm q-mt-sm",icon:r(m).BACK,onClick:i[0]||(i[0]=e=>r(Q)())},null,8,["icon"])]),g("div",ie,[g("div",ue,[t(J,{disable:!u.value.length,outlined:"",dense:"",clearable:"",debounce:"300",modelValue:I.value,"onUpdate:modelValue":i[2]||(i[2]=e=>I.value=e),placeholder:"Search"},{before:o(()=>[t(le,{modelValue:T.value,"onUpdate:modelValue":i[1]||(i[1]=e=>T.value=e),options:A.value,disable:!u.value.length,"bg-color":"primary",standout:"",multiple:"",dense:"","options-dense":"","emit-value":"","map-options":"","option-value":"name","display-value":""},{prepend:o(()=>[t(q,{color:"white",name:r(m).OPTIONS},null,8,["name"])]),_:1},8,["modelValue","options","disable"])]),append:o(()=>[t(q,{name:"search"})]),_:1},8,["disable","modelValue"])])])]),bottom:o(()=>[v(E(r(W)(u.value)),1)]),_:1},8,["rows","columns","visible-columns","filter"]))}});export{he as default};
