import{h as c,r as V,aN as W,E as G,aO as K,aP as J,z as X,aQ as Y,d as Z,a as ee,c as S,e as ae,w as u,f as o,Q as te,l as E,t as x,j as q,a4 as j,a6 as A,m as b,I as y,a7 as N,n as re,a2 as T,a1 as ne,aR as oe,aS as se,i as ie,b as P}from"./index-e3c69f77.js";import{Q as F,a as g}from"./QItem-1157b8a8.js";import{Q as le}from"./QList-c451365e.js";import{Q as de}from"./QMenu-0157e0b4.js";import{Q as ue}from"./QBadge-5312c4bc.js";import{u as fe}from"./useDialogs-7ca8682a.js";import{u as ce}from"./useRoutables-53d778ec.js";function k(e){return K()?(J(e),!0):!1}function R(e){return typeof e=="function"?e():c(e)}const Q=typeof window<"u";function me(e,a=1e3,t={}){const{immediate:r=!0,immediateCallback:i=!1}=t;let l=null;const f=V(!1);function m(){l&&(clearInterval(l),l=null)}function C(){f.value=!1,m()}function p(){const w=R(a);w<=0||(f.value=!0,i&&e(),m(),l=setInterval(e,w))}if(r&&Q&&p(),W(a)||typeof a=="function"){const w=G(a,()=>{f.value&&Q&&p()});k(w)}return k(C),{isActive:f,pause:C,resume:p}}const ve=Q?window:void 0;function ye(e,a={}){const{immediate:t=!0,window:r=ve}=a,i=V(!1);let l=0,f=null;function m(w){if(!i.value||!r)return;const d=w-l;e({delta:d,timestamp:w}),l=w,f=r.requestAnimationFrame(m)}function C(){!i.value&&r&&(i.value=!0,f=r.requestAnimationFrame(m))}function p(){i.value=!1,f!=null&&r&&(r.cancelAnimationFrame(f),f=null)}return t&&C(),k(p),{isActive:Y(i),pause:p,resume:C}}var he=Object.defineProperty,L=Object.getOwnPropertySymbols,pe=Object.prototype.hasOwnProperty,we=Object.prototype.propertyIsEnumerable,U=(e,a,t)=>a in e?he(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,Ce=(e,a)=>{for(var t in a||(a={}))pe.call(a,t)&&U(e,t,a[t]);if(L)for(var t of L(a))we.call(a,t)&&U(e,t,a[t]);return e};function be(e={}){const{controls:a=!1,interval:t="requestAnimationFrame"}=e,r=V(new Date),i=()=>r.value=new Date,l=t==="requestAnimationFrame"?ye(i,{immediate:!0}):me(i,t,{immediate:!0});return a?Ce({now:r},l):r}var $e=Object.defineProperty,I=Object.getOwnPropertySymbols,M=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable,B=(e,a,t)=>a in e?$e(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,ge=(e,a)=>{for(var t in a||(a={}))M.call(a,t)&&B(e,t,a[t]);if(I)for(var t of I(a))z.call(a,t)&&B(e,t,a[t]);return e},De=(e,a)=>{var t={};for(var r in e)M.call(e,r)&&a.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&I)for(var r of I(e))a.indexOf(r)<0&&z.call(e,r)&&(t[r]=e[r]);return t};const Ee=[{max:6e4,value:1e3,name:"second"},{max:276e4,value:6e4,name:"minute"},{max:72e6,value:36e5,name:"hour"},{max:5184e5,value:864e5,name:"day"},{max:24192e5,value:6048e5,name:"week"},{max:28512e6,value:2592e6,name:"month"},{max:1/0,value:31536e6,name:"year"}],Oe={justNow:"just now",past:e=>e.match(/\d/)?`${e} ago`:e,future:e=>e.match(/\d/)?`in ${e}`:e,month:(e,a)=>e===1?a?"last month":"next month":`${e} month${e>1?"s":""}`,year:(e,a)=>e===1?a?"last year":"next year":`${e} year${e>1?"s":""}`,day:(e,a)=>e===1?a?"yesterday":"tomorrow":`${e} day${e>1?"s":""}`,week:(e,a)=>e===1?a?"last week":"next week":`${e} week${e>1?"s":""}`,hour:e=>`${e} hour${e>1?"s":""}`,minute:e=>`${e} minute${e>1?"s":""}`,second:e=>`${e} second${e>1?"s":""}`,invalid:""};function xe(e){return e.toISOString().slice(0,10)}function Te(e,a={}){const{controls:t=!1,updateInterval:r=3e4}=a,i=be({interval:r,controls:!0}),{now:l}=i,f=De(i,["now"]),m=X(()=>Fe(new Date(R(e)),a,R(l.value)));return t?ge({timeAgo:m},f):m}function Fe(e,a={},t=Date.now()){var r;const{max:i,messages:l=Oe,fullDateFormatter:f=xe,units:m=Ee,showSecond:C=!1,rounding:p="round"}=a,w=typeof p=="number"?v=>+v.toFixed(p):Math[p],d=+t-+e,n=Math.abs(d);function s(v,h){return w(Math.abs(v)/h.value)}function $(v,h){const O=s(v,h),D=v>0,H=_(h.name,O,D);return _(D?"past":"future",H,D)}function _(v,h,O){const D=l[v];return typeof D=="function"?D(h,O):D.replace("{0}",h.toString())}if(n<6e4&&!C)return l.justNow;if(typeof i=="number"&&n>i)return f(new Date(e));if(typeof i=="string"){const v=(r=m.find(h=>h.name===i))==null?void 0:r.max;if(v&&n>v)return f(new Date(e))}for(const[v,h]of m.entries()){if(s(d,h)<=0&&m[v-1])return $(d,m[v-1]);if(n<h.max)return $(d,h)}return l.invalid}const Ie={class:"text-h6"},Se={key:0},Ae={class:"absolute-top-right q-ma-xs"},Ne={class:"q-mb-md"},Pe={class:"text-caption q-ml-xs"},ke={key:0},Re={class:"text-caption q-ml-xs"},Be=Z({__name:"DashboardParentCard",props:{showDescription:{type:Boolean},dashboardCard:null},setup(e){const{log:a}=ee(),{goToInspect:t,goToEdit:r,goToCharts:i}=ce(),{confirmDialog:l,dismissDialog:f}=fe();async function m(d){f("Previous Note",d,y.NOTE,"info")}async function C(d,n,s){l("Favorite",`Do you want to favorite ${s}?`,y.FAVORITE_ON,"info",async()=>{try{await P.updateRecord(d,n,{favorited:!0}),a.info(`${s} favorited`,{type:d,id:n,name:s})}catch($){a.error("Favorite update failed",$)}})}async function p(d,n,s){l("Unfavorite",`Do you want to unfavorite ${s}?`,y.FAVORITE_OFF,"info",async()=>{try{await P.updateRecord(d,n,{favorited:!1}),a.info(`${s} unfavorited`,{type:d,id:n,name:s})}catch($){a.error("Unfavorite update failed",$)}})}async function w(d,n,s){l("Delete",`Permanently delete ${s}? This will also delete any underlying child records.`,y.DELETE,"negative",async()=>{try{await P.deleteRecord(d,n),a.info(`${s} and grouped records deleted`,{type:d,id:n,name:s})}catch($){a.error("Delete failed",$)}})}return(d,n)=>(S(),ae(ie,null,{default:u(()=>[o(te,null,{default:u(()=>[E("p",Ie,x(e.dashboardCard.name),1),e.showDescription?(S(),q("p",Se,x(e.dashboardCard.desc),1)):j("",!0),E("div",Ae,[A(o(b,{name:c(y).NOTE,color:"primary",size:"md",class:"cursor-pointer q-mr-xs",onClick:n[0]||(n[0]=s=>m(e.dashboardCard.previousNote||""))},null,8,["name"]),[[N,e.dashboardCard.previousNote]]),A(o(b,{name:c(y).FAVORITE_ON,color:"warning",size:"md",class:"cursor-pointer",onClick:n[1]||(n[1]=s=>p(e.dashboardCard.type,e.dashboardCard.id,e.dashboardCard.name))},null,8,["name"]),[[N,e.dashboardCard.favorited]]),A(o(b,{name:c(y).FAVORITE_OFF,color:"grey",size:"md",class:"cursor-pointer",onClick:n[2]||(n[2]=s=>C(e.dashboardCard.type,e.dashboardCard.id,e.dashboardCard.name))},null,8,["name"]),[[N,!e.dashboardCard.favorited]]),o(re,{round:"",flat:"",icon:c(y).MENU_VERTICAL},{default:u(()=>[o(de,{"auto-close":"",anchor:"top right","transition-show":"flip-right","transition-hide":"flip-left"},{default:u(()=>[o(le,null,{default:u(()=>[o(F,{clickable:"",onClick:n[3]||(n[3]=s=>c(i)(e.dashboardCard.type,e.dashboardCard.id))},{default:u(()=>[o(g,{avatar:""},{default:u(()=>[o(b,{color:"accent",name:c(y).CHARTS},null,8,["name"])]),_:1}),o(g,null,{default:u(()=>[T("Charts")]),_:1})]),_:1}),o(F,{clickable:"",onClick:n[4]||(n[4]=s=>c(t)(e.dashboardCard.type,e.dashboardCard.id))},{default:u(()=>[o(g,{avatar:""},{default:u(()=>[o(b,{color:"primary",name:c(y).INSPECT},null,8,["name"])]),_:1}),o(g,null,{default:u(()=>[T("Inspect")]),_:1})]),_:1}),o(F,{clickable:"",onClick:n[5]||(n[5]=s=>c(r)(e.dashboardCard.type,e.dashboardCard.id))},{default:u(()=>[o(g,{avatar:""},{default:u(()=>[o(b,{color:"warning",name:c(y).EDIT},null,8,["name"])]),_:1}),o(g,null,{default:u(()=>[T("Edit")]),_:1})]),_:1}),o(ne),o(F,{clickable:"",onClick:n[6]||(n[6]=s=>w(e.dashboardCard.type,e.dashboardCard.id,e.dashboardCard.name))},{default:u(()=>[o(g,{avatar:""},{default:u(()=>[o(b,{color:"negative",name:c(y).DELETE},null,8,["name"])]),_:1}),o(g,null,{default:u(()=>[T("Delete")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["icon"])]),E("div",Ne,[o(ue,{rounded:"",color:"secondary",class:"q-py-none"},{default:u(()=>[o(b,{name:c(y).PREVIOUS},null,8,["name"]),E("span",Pe,x(c(Te)(e.dashboardCard.previousTimestamp||"").value||"No previous records"),1)]),_:1}),e.dashboardCard.previousTimestamp?(S(),q("div",ke,[o(b,{name:c(y).CALENDAR_CHECK},null,8,["name"]),E("span",Re,x(c(oe)(e.dashboardCard.previousTimestamp)),1)])):j("",!0)]),E("div",null,[se(d.$slots,"default")])]),_:3})]),_:3}))}});export{Be as _};
