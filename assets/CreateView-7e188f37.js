import{q as S,N as k,G as x,t as A,O as h,r as B,ab as R,a0 as u,ap as $,x as q,y as t,z as C,A as m,u as e,S as f,B as o,C as N,Q as V,I as c,L as Q,X as T,U as F,T as L,E as i,J as j,Y as z,Z as G,aq as M,D as U,ar as W}from"./index-5cff7ac3.js";import{_ as J,Q as O}from"./ParentInfoCard.vue_vue_type_script_setup_true_lang-3328d601.js";import{_ as X}from"./ResponsivePage.vue_vue_type_script_setup_true_lang-639c5f80.js";import{u as Y}from"./useRoutables-30265fa0.js";import{u as Z}from"./action-d0cf9b67.js";import{u as H}from"./useDialogs-b7894612.js";const K={key:0},P=i("span",{class:"q-ml-md"},"Error rendering this record",-1),ee={key:1},ae={class:"row justify-center q-my-sm"},re={class:"row justify-center"},se=i("span",{class:"text-caption q-ml-xs text-warning"}," Correct invalid entries and try again ",-1),ue=S({__name:"CreateView",setup(te){k({title:`${x} - Create Record`});const{routeGroup:_,routeType:n,routeCoreId:v,goBack:w}=Y(),{log:p}=A(),{confirmDialog:I}=H(),a=Z(),g=h.getLabel(_,n,"singular"),b=h.getFieldProps(_,n),y=B(!0);R(async()=>{try{a.record[u.Values.id]=$(),a.record[u.Values.type]=n,v&&(a.record[u.Values.coreId]=v)}catch(r){p.error("Error loading create view",r)}}),q(()=>{a.$reset()});async function D(){I("Create",`Create ${g} record?`,c.CREATE,"positive",async()=>{try{const r=M(!0,{},a.record);await U.addRecord(_,n,r),p.info("Successfully created record",{id:r[u.Values.id],type:n}),w()}catch(r){p.error("Create failed",r)}})}return(r,l)=>(t(),C(X,{bannerIcon:e(c).CREATE,bannerTitle:`Create ${e(g)}`},{default:m(()=>[!e(g)||!e(b)?(t(),f("div",K,[o(Q,{class:"q-mb-md"},{default:m(()=>[o(N,null,{default:m(()=>[o(V,{name:e(c).WARN,size:"md",color:"warning"},null,8,["name"]),P]),_:1})]),_:1})])):(t(),f("div",ee,[o(O,{onSubmit:D,onValidationError:l[0]||(l[0]=d=>y.value=!1),onValidationSuccess:l[1]||(l[1]=d=>y.value=!0)},{default:m(()=>{var d;return[(d=e(a).record)!=null&&d.coreId?(t(),C(J,{key:0,coreId:e(a).record.coreId},null,8,["coreId"])):T("",!0),(t(!0),f(F,null,L(e(b),(s,E)=>(t(),f("div",{key:E,class:"q-mb-md"},[(t(),C(W(s.component),{field:s.field,label:s.label,desc:s.desc,getDefault:s.getDefault,schema:s.schema,message:s.message},null,8,["field","label","desc","getDefault","schema","message"]))]))),128)),i("div",ae,[o(j,{label:"Create",type:"submit",color:"positive",icon:e(c).SAVE},null,8,["icon"])]),i("div",re,[z(i("div",null,[o(V,{name:e(c).WARN,color:"warning"},null,8,["name"]),se],512),[[G,!y.value]])])]}),_:1})]))]),_:1},8,["bannerIcon","bannerTitle"]))}});export{ue as default};
