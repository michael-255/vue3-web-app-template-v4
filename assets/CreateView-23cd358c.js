import{q as x,N as A,G as B,t as R,O as g,r as k,ab as q,a0 as l,ap as D,x as I,y as a,z as b,A as d,u as e,S as u,B as t,C as Q,Q as w,I as n,L as $,U as N,T,E as i,J as F,Y as L,Z as j,aq as z,D as G,ar as M}from"./index-408197b4.js";import{Q as U}from"./QForm-c7e690cc.js";import{_ as W}from"./ResponsivePage.vue_vue_type_script_setup_true_lang-729e840e.js";import{u as J}from"./useRoutables-132fa327.js";import{u as O}from"./action-4701911f.js";import{u as Y}from"./useDialogs-fad27234.js";import"./QSelect-436eab52.js";import"./QItem-404b2f94.js";import"./QItemLabel-3e7d15e3.js";import"./QMenu-c4003d51.js";import"./selection-cd46e154.js";import"./ui-65b145aa.js";const Z={key:0},H=i("span",{class:"q-ml-md"},"Error rendering this record",-1),K={key:1},P={class:"row justify-center q-my-sm"},X={class:"row justify-center"},ee=i("span",{class:"text-caption q-ml-xs text-warning"}," Correct invalid entries and try again ",-1),fe=x({__name:"CreateView",setup(re){A({title:`${B} - Create Record`});const{routeGroup:m,routeType:o,routeCoreId:v,goBack:V}=J(),{log:p}=R(),{confirmDialog:h}=Y(),s=O(),f=g.getLabel(m,o,"singular"),C=g.getFields(m,o),_=k(!0);q(async()=>{try{s.record[l.Values.id]=D(),s.record[l.Values.type]=o,v&&(s.record[l.Values.coreId]=v)}catch(r){p.error("Error loading create view",r)}}),I(()=>{s.$reset()});async function E(){h("Create",`Create ${f} record?`,n.CREATE,"positive",async()=>{try{const r=z(!0,{},s.record);await G.addRecord(m,o,r),p.info("Successfully created record",{id:r[l.Values.id],type:o}),V()}catch(r){p.error("Create failed",r)}})}return(r,c)=>(a(),b(W,{bannerIcon:e(n).CREATE,bannerTitle:`Create ${e(f)}`},{default:d(()=>[!e(f)||!e(C)?(a(),u("div",Z,[t($,{class:"q-mb-md"},{default:d(()=>[t(Q,null,{default:d(()=>[t(w,{name:e(n).WARN,size:"md",color:"warning"},null,8,["name"]),H]),_:1})]),_:1})])):(a(),u("div",K,[t(U,{onSubmit:E,onValidationError:c[0]||(c[0]=y=>_.value=!1),onValidationSuccess:c[1]||(c[1]=y=>_.value=!0)},{default:d(()=>[(a(!0),u(N,null,T(e(C),(y,S)=>(a(),u("div",{key:S,class:"q-mb-md"},[(a(),b(M(y),{inspecting:!1}))]))),128)),i("div",P,[t(F,{label:"Create",type:"submit",color:"positive",icon:e(n).SAVE},null,8,["icon"])]),i("div",X,[L(i("div",null,[t(w,{name:e(n).WARN,color:"warning"},null,8,["name"]),ee],512),[[j,!_.value]])])]),_:1})]))]),_:1},8,["bannerIcon","bannerTitle"]))}});export{fe as default};
