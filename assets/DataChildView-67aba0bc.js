import{Q as y,a as D,b as T,c as P}from"./QTable-89773ff3.js";import{d as A,b as F,A as O,e as j,r as c,J as k,D as C,f as E,h as R,j as d,k as _,l as o,m as t,q as x,s as Q,F as S,G as m,x as p,u as l,I as r,n as v,t as f,Q as I,K as U,v as G,C as J,E as K,M as z}from"./index-5d245f77.js";import{Q as H}from"./QSelect-65e68149.js";import{u as W}from"./useRoutables-128af855.js";import{u as X}from"./useDialogs-7677fd0b.js";import"./QList-3c4dfd94.js";import"./QItem-6c91178d.js";import"./QItemLabel-35dc4d65.js";import"./QMenu-36ba3952.js";import"./selection-280b5155.js";import"./SimpleDialog.vue_vue_type_script_setup_true_lang-9013e5dc.js";const Y={class:"row justify-start full-width q-mb-md"},Z={class:"col-10 text-h6 text-bold ellipsis"},ee={class:"row justify-start full-width"},le={class:"col-12"},ve=A({__name:"DataChildView",setup(oe){F({title:`${O} - Records Data`});const{log:h}=j(),{routeType:i,goToChildInspect:V,goToChildEdit:q,goBack:B}=W(),{confirmDialog:L}=X(),b=c(""),u=c([]),g=c([k.ID,k.TIMESTAMP]),w=c(C.getChildTableColumns(i)),N=c(w.value.filter(a=>!a.required)),$=E.liveChildren(i).subscribe({next:a=>{u.value=a},error:a=>{h.error("Error fetching live child records",a)}});R(()=>{$.unsubscribe()});async function M(a){let n=`Permanently delete ${C.getChildLabelSingular(i)} with id ${a}?`;L("Delete",n,r.DELETE,"negative",async()=>{try{await E.deleteChild(a),h.info("Successfully deleted record",{type:i,id:a})}catch(e){h.error("Delete failed",e)}})}return(a,n)=>(d(),_(P,{rows:u.value,columns:w.value,"visible-columns":g.value,"rows-per-page-options":[0],filter:b.value,"virtual-scroll":"",fullscreen:"","row-key":"id"},{header:o(e=>[t(D,{props:e},{default:o(()=>[(d(!0),x(S,null,Q(e.cols,s=>J((d(),_(y,{key:s.name,props:e},{default:o(()=>[m(f(s.label),1)]),_:2},1032,["props"])),[[K,!l(z).includes(s.name)]])),128)),t(y,{"auto-width":"",class:"text-left"},{default:o(()=>[m("Actions")]),_:1})]),_:2},1032,["props"])]),body:o(e=>[t(D,{props:e},{default:o(()=>[(d(!0),x(S,null,Q(e.cols,s=>(d(),_(T,{key:s.name,props:e},{default:o(()=>[m(f(s.value),1)]),_:2},1032,["props"]))),128)),t(T,{"auto-width":""},{default:o(()=>[t(p,{flat:"",round:"",dense:"",class:"q-ml-xs",color:"primary",icon:l(r).INSPECT,onClick:s=>l(V)(l(i),e.cols[0].value)},null,8,["icon","onClick"]),t(p,{flat:"",round:"",dense:"",class:"q-ml-xs",color:"orange-9",icon:l(r).EDIT,onClick:s=>l(q)(l(i),e.cols[0].value)},null,8,["icon","onClick"]),t(p,{flat:"",round:"",dense:"",class:"q-ml-xs",color:"negative",onClick:s=>M(e.cols[0].value),icon:l(r).DELETE},null,8,["onClick","icon"])]),_:2},1024)]),_:2},1032,["props"])]),top:o(()=>[v("div",Y,[v("div",Z,f(l(C).getChildLabelPlural(l(i))),1),t(p,{round:"",flat:"",class:"absolute-top-right q-mr-sm q-mt-sm",icon:l(r).CLOSE,onClick:n[0]||(n[0]=e=>l(B)())},null,8,["icon"])]),v("div",ee,[v("div",le,[t(U,{disable:!u.value.length,outlined:"",dense:"",clearable:"",debounce:"300",modelValue:b.value,"onUpdate:modelValue":n[2]||(n[2]=e=>b.value=e),placeholder:"Search"},{before:o(()=>[t(H,{modelValue:g.value,"onUpdate:modelValue":n[1]||(n[1]=e=>g.value=e),options:N.value,disable:!u.value.length,"bg-color":"primary",standout:"",multiple:"",dense:"","options-dense":"","emit-value":"","map-options":"","option-value":"name","display-value":""},{prepend:o(()=>[t(I,{color:"white",name:l(r).OPTIONS},null,8,["name"])]),_:1},8,["modelValue","options","disable"])]),append:o(()=>[t(I,{name:"search"})]),_:1},8,["disable","modelValue"])])])]),bottom:o(()=>[m(f(l(G)(u.value)),1)]),_:1},8,["rows","columns","visible-columns","filter"]))}});export{ve as default};
