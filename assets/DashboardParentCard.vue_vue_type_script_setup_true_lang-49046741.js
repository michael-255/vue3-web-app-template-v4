import{h as c,r as k,aO as W,E as G,aP as K,aQ as J,z as X,aR as Y,d as Z,a as ee,c as F,e as ae,w as m,f as s,Q as te,l as $,t as D,j as q,a4 as j,a6 as I,m as C,I as y,a7 as T,n as oe,a2 as A,aS as re,aT as ne,i as se,b as U}from"./index-aa65fb50.js";import{Q as S,a as g}from"./QItem-4a774405.js";import{Q as ie}from"./QList-7d3cd984.js";import{Q as le}from"./QMenu-514d03ae.js";import{Q as ue}from"./QBadge-dd274165.js";import{u as de}from"./useDialogs-f212f341.js";import{u as fe}from"./useRoutables-e4e4cb76.js";function N(e){return K()?(J(e),!0):!1}function P(e){return typeof e=="function"?e():c(e)}const R=typeof window<"u";function me(e,a=1e3,o={}){const{immediate:r=!0,immediateCallback:i=!1}=o;let l=null;const d=k(!1);function f(){l&&(clearInterval(l),l=null)}function w(){d.value=!1,f()}function h(){const t=P(a);t<=0||(d.value=!0,i&&e(),f(),l=setInterval(e,t))}if(r&&R&&h(),W(a)||typeof a=="function"){const t=G(a,()=>{d.value&&R&&h()});N(t)}return N(w),{isActive:d,pause:w,resume:h}}const ce=R?window:void 0;function pe(e,a={}){const{immediate:o=!0,window:r=ce}=a,i=k(!1);let l=0,d=null;function f(t){if(!i.value||!r)return;const n=t-l;e({delta:n,timestamp:t}),l=t,d=r.requestAnimationFrame(f)}function w(){!i.value&&r&&(i.value=!0,d=r.requestAnimationFrame(f))}function h(){i.value=!1,d!=null&&r&&(r.cancelAnimationFrame(d),d=null)}return o&&w(),N(h),{isActive:Y(i),pause:h,resume:w}}var ve=Object.defineProperty,B=Object.getOwnPropertySymbols,he=Object.prototype.hasOwnProperty,ye=Object.prototype.propertyIsEnumerable,M=(e,a,o)=>a in e?ve(e,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[a]=o,we=(e,a)=>{for(var o in a||(a={}))he.call(a,o)&&M(e,o,a[o]);if(B)for(var o of B(a))ye.call(a,o)&&M(e,o,a[o]);return e};function Ce(e={}){const{controls:a=!1,interval:o="requestAnimationFrame"}=e,r=k(new Date),i=()=>r.value=new Date,l=o==="requestAnimationFrame"?pe(i,{immediate:!0}):me(i,o,{immediate:!0});return a?we({now:r},l):r}var be=Object.defineProperty,E=Object.getOwnPropertySymbols,L=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable,x=(e,a,o)=>a in e?be(e,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[a]=o,_e=(e,a)=>{for(var o in a||(a={}))L.call(a,o)&&x(e,o,a[o]);if(E)for(var o of E(a))z.call(a,o)&&x(e,o,a[o]);return e},$e=(e,a)=>{var o={};for(var r in e)L.call(e,r)&&a.indexOf(r)<0&&(o[r]=e[r]);if(e!=null&&E)for(var r of E(e))a.indexOf(r)<0&&z.call(e,r)&&(o[r]=e[r]);return o};const ge=[{max:6e4,value:1e3,name:"second"},{max:276e4,value:6e4,name:"minute"},{max:72e6,value:36e5,name:"hour"},{max:5184e5,value:864e5,name:"day"},{max:24192e5,value:6048e5,name:"week"},{max:28512e6,value:2592e6,name:"month"},{max:1/0,value:31536e6,name:"year"}],Oe={justNow:"just now",past:e=>e.match(/\d/)?`${e} ago`:e,future:e=>e.match(/\d/)?`in ${e}`:e,month:(e,a)=>e===1?a?"last month":"next month":`${e} month${e>1?"s":""}`,year:(e,a)=>e===1?a?"last year":"next year":`${e} year${e>1?"s":""}`,day:(e,a)=>e===1?a?"yesterday":"tomorrow":`${e} day${e>1?"s":""}`,week:(e,a)=>e===1?a?"last week":"next week":`${e} week${e>1?"s":""}`,hour:e=>`${e} hour${e>1?"s":""}`,minute:e=>`${e} minute${e>1?"s":""}`,second:e=>`${e} second${e>1?"s":""}`,invalid:""};function De(e){return e.toISOString().slice(0,10)}function Ee(e,a={}){const{controls:o=!1,updateInterval:r=3e4}=a,i=Ce({interval:r,controls:!0}),{now:l}=i,d=$e(i,["now"]),f=X(()=>Fe(new Date(P(e)),a,P(l.value)));return o?_e({timeAgo:f},d):f}function Fe(e,a={},o=Date.now()){var r;const{max:i,messages:l=Oe,fullDateFormatter:d=De,units:f=ge,showSecond:w=!1,rounding:h="round"}=a,t=typeof h=="number"?p=>+p.toFixed(h):Math[h],n=+o-+e,u=Math.abs(n);function _(p,v){return t(Math.abs(p)/v.value)}function Q(p,v){const O=_(p,v),b=p>0,H=V(v.name,O,b);return V(b?"past":"future",H,b)}function V(p,v,O){const b=l[p];return typeof b=="function"?b(v,O):b.replace("{0}",v.toString())}if(u<6e4&&!w)return l.justNow;if(typeof i=="number"&&u>i)return d(new Date(e));if(typeof i=="string"){const p=(r=f.find(v=>v.name===i))==null?void 0:r.max;if(p&&u>p)return d(new Date(e))}for(const[p,v]of f.entries()){if(_(n,v)<=0&&f[p-1])return Q(n,f[p-1]);if(u<v.max)return Q(n,v)}return l.invalid}const Ie={class:"text-h6"},Te={key:0},Ae={class:"absolute-top-right q-ma-xs"},Se={class:"q-mb-md"},Ne={class:"text-caption q-ml-xs"},Pe={key:0},Re={class:"text-caption q-ml-xs"},Me=Z({__name:"DashboardParentCard",props:{showDescription:{type:Boolean},dashboardCard:{}},setup(e){const{log:a}=ee(),{goToInspect:o,goToEdit:r,goToCharts:i}=fe(),{confirmDialog:l,dismissDialog:d}=de();async function f(t){d("Previous Note",t,y.NOTE,"info")}async function w(t,n,u){l("Favorite",`Do you want to favorite ${u}?`,y.FAVORITE_ON,"info",async()=>{try{await U.updateRecord(t,n,{favorited:!0}),a.info(`${u} favorited`,{type:t,id:n,name:u})}catch(_){a.error("Favorite update failed",_)}})}async function h(t,n,u){l("Unfavorite",`Do you want to unfavorite ${u}?`,y.FAVORITE_OFF,"info",async()=>{try{await U.updateRecord(t,n,{favorited:!1}),a.info(`${u} unfavorited`,{type:t,id:n,name:u})}catch(_){a.error("Unfavorite update failed",_)}})}return(t,n)=>(F(),ae(se,null,{default:m(()=>[s(te,null,{default:m(()=>[$("p",Ie,D(t.dashboardCard.name),1),t.showDescription?(F(),q("p",Te,D(t.dashboardCard.desc),1)):j("",!0),$("div",Ae,[I(s(C,{name:c(y).NOTE,color:"primary",size:"md",class:"cursor-pointer q-mr-xs",onClick:n[0]||(n[0]=u=>f(t.dashboardCard.previousNote||""))},null,8,["name"]),[[T,t.dashboardCard.previousNote]]),I(s(C,{name:c(y).FAVORITE_ON,color:"warning",size:"md",class:"cursor-pointer",onClick:n[1]||(n[1]=u=>h(t.dashboardCard.type,t.dashboardCard.id,t.dashboardCard.name))},null,8,["name"]),[[T,t.dashboardCard.favorited]]),I(s(C,{name:c(y).FAVORITE_OFF,color:"grey",size:"md",class:"cursor-pointer",onClick:n[2]||(n[2]=u=>w(t.dashboardCard.type,t.dashboardCard.id,t.dashboardCard.name))},null,8,["name"]),[[T,!t.dashboardCard.favorited]]),s(oe,{round:"",flat:"",icon:c(y).MENU_VERTICAL},{default:m(()=>[s(le,{"auto-close":"",anchor:"top right","transition-show":"flip-right","transition-hide":"flip-left"},{default:m(()=>[s(ie,null,{default:m(()=>[s(S,{clickable:"",onClick:n[3]||(n[3]=u=>c(i)(t.dashboardCard.type,t.dashboardCard.id))},{default:m(()=>[s(g,{avatar:""},{default:m(()=>[s(C,{color:"accent",name:c(y).CHARTS},null,8,["name"])]),_:1}),s(g,null,{default:m(()=>[A("Charts")]),_:1})]),_:1}),s(S,{clickable:"",onClick:n[4]||(n[4]=u=>c(o)(t.dashboardCard.type,t.dashboardCard.id))},{default:m(()=>[s(g,{avatar:""},{default:m(()=>[s(C,{color:"primary",name:c(y).INSPECT},null,8,["name"])]),_:1}),s(g,null,{default:m(()=>[A("Inspect")]),_:1})]),_:1}),s(S,{clickable:"",onClick:n[5]||(n[5]=u=>c(r)(t.dashboardCard.type,t.dashboardCard.id))},{default:m(()=>[s(g,{avatar:""},{default:m(()=>[s(C,{color:"warning",name:c(y).EDIT},null,8,["name"])]),_:1}),s(g,null,{default:m(()=>[A("Edit")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["icon"])]),$("div",Se,[s(ue,{rounded:"",color:"secondary",class:"q-py-none"},{default:m(()=>[s(C,{name:c(y).PREVIOUS},null,8,["name"]),$("span",Ne,D(c(Ee)(t.dashboardCard.previousTimestamp||"").value||"No previous records"),1)]),_:1}),t.dashboardCard.previousTimestamp?(F(),q("div",Pe,[s(C,{name:c(y).CALENDAR_CHECK},null,8,["name"]),$("span",Re,D(c(re)(t.dashboardCard.previousTimestamp)),1)])):j("",!0)]),$("div",null,[ne(t.$slots,"default")])]),_:3})]),_:3}))}});export{Me as _};
