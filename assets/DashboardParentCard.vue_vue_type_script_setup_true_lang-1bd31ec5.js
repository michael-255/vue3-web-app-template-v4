import{q as G,z as k,v as K,P as J,h as f,r as V,aM as X,E as Y,aN as Z,aO as ee,aP as ae,d as te,a as ne,c as I,e as oe,w as d,f as r,Q as re,l as D,t as O,j as _,a4 as L,a6 as A,m as w,I as y,a7 as N,n as le,a2 as S,a1 as ie,aQ as se,aR as ue,i as de,b as P}from"./index-28c8bf0b.js";import{Q as T,a as p}from"./QItem-b926f8e7.js";import{Q as ce}from"./QList-a0329fde.js";import{Q as fe}from"./QMenu-9b6e07a8.js";import{u as me}from"./useDialogs-b7de82d7.js";import{u as ve}from"./useRoutables-1c239c02.js";const ye=["top","middle","bottom"],he=G({name:"QBadge",props:{color:String,textColor:String,floating:Boolean,transparent:Boolean,multiLine:Boolean,outline:Boolean,rounded:Boolean,label:[Number,String],align:{type:String,validator:e=>ye.includes(e)}},setup(e,{slots:a}){const t=k(()=>e.align!==void 0?{verticalAlign:e.align}:null),n=k(()=>{const l=e.outline===!0&&e.color||e.textColor;return`q-badge flex inline items-center no-wrap q-badge--${e.multiLine===!0?"multi":"single"}-line`+(e.outline===!0?" q-badge--outline":e.color!==void 0?` bg-${e.color}`:"")+(l!==void 0?` text-${l}`:"")+(e.floating===!0?" q-badge--floating":"")+(e.rounded===!0?" q-badge--rounded":"")+(e.transparent===!0?" q-badge--transparent":"")});return()=>K("div",{class:n.value,style:t.value,role:"status","aria-label":e.label},J(a.default,e.label!==void 0?[e.label]:[]))}});function R(e){return Z()?(ee(e),!0):!1}function q(e){return typeof e=="function"?e():f(e)}const Q=typeof window<"u";function ge(e,a=1e3,t={}){const{immediate:n=!0,immediateCallback:l=!1}=t;let s=null;const c=V(!1);function m(){s&&(clearInterval(s),s=null)}function C(){c.value=!1,m()}function g(){const b=q(a);b<=0||(c.value=!0,l&&e(),m(),s=setInterval(e,b))}if(n&&Q&&g(),X(a)||typeof a=="function"){const b=Y(a,()=>{c.value&&Q&&g()});R(b)}return R(C),{isActive:c,pause:C,resume:g}}const be=Q?window:void 0;function Ce(e,a={}){const{immediate:t=!0,window:n=be}=a,l=V(!1);let s=0,c=null;function m(b){if(!l.value||!n)return;const u=b-s;e({delta:u,timestamp:b}),s=b,c=n.requestAnimationFrame(m)}function C(){!l.value&&n&&(l.value=!0,c=n.requestAnimationFrame(m))}function g(){l.value=!1,c!=null&&n&&(n.cancelAnimationFrame(c),c=null)}return t&&C(),R(g),{isActive:ae(l),pause:g,resume:C}}var we=Object.defineProperty,M=Object.getOwnPropertySymbols,$e=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable,j=(e,a,t)=>a in e?we(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,xe=(e,a)=>{for(var t in a||(a={}))$e.call(a,t)&&j(e,t,a[t]);if(M)for(var t of M(a))pe.call(a,t)&&j(e,t,a[t]);return e};function De(e={}){const{controls:a=!1,interval:t="requestAnimationFrame"}=e,n=V(new Date),l=()=>n.value=new Date,s=t==="requestAnimationFrame"?Ce(l,{immediate:!0}):ge(l,t,{immediate:!0});return a?xe({now:n},s):n}var Ee=Object.defineProperty,F=Object.getOwnPropertySymbols,z=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable,U=(e,a,t)=>a in e?Ee(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,Oe=(e,a)=>{for(var t in a||(a={}))z.call(a,t)&&U(e,t,a[t]);if(F)for(var t of F(a))H.call(a,t)&&U(e,t,a[t]);return e},Se=(e,a)=>{var t={};for(var n in e)z.call(e,n)&&a.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&F)for(var n of F(e))a.indexOf(n)<0&&H.call(e,n)&&(t[n]=e[n]);return t};const Te=[{max:6e4,value:1e3,name:"second"},{max:276e4,value:6e4,name:"minute"},{max:72e6,value:36e5,name:"hour"},{max:5184e5,value:864e5,name:"day"},{max:24192e5,value:6048e5,name:"week"},{max:28512e6,value:2592e6,name:"month"},{max:1/0,value:31536e6,name:"year"}],Fe={justNow:"just now",past:e=>e.match(/\d/)?`${e} ago`:e,future:e=>e.match(/\d/)?`in ${e}`:e,month:(e,a)=>e===1?a?"last month":"next month":`${e} month${e>1?"s":""}`,year:(e,a)=>e===1?a?"last year":"next year":`${e} year${e>1?"s":""}`,day:(e,a)=>e===1?a?"yesterday":"tomorrow":`${e} day${e>1?"s":""}`,week:(e,a)=>e===1?a?"last week":"next week":`${e} week${e>1?"s":""}`,hour:e=>`${e} hour${e>1?"s":""}`,minute:e=>`${e} minute${e>1?"s":""}`,second:e=>`${e} second${e>1?"s":""}`,invalid:""};function Ie(e){return e.toISOString().slice(0,10)}function Ae(e,a={}){const{controls:t=!1,updateInterval:n=3e4}=a,l=De({interval:n,controls:!0}),{now:s}=l,c=Se(l,["now"]),m=k(()=>Ne(new Date(q(e)),a,q(s.value)));return t?Oe({timeAgo:m},c):m}function Ne(e,a={},t=Date.now()){var n;const{max:l,messages:s=Fe,fullDateFormatter:c=Ie,units:m=Te,showSecond:C=!1,rounding:g="round"}=a,b=typeof g=="number"?v=>+v.toFixed(g):Math[g],u=+t-+e,o=Math.abs(u);function i(v,h){return b(Math.abs(v)/h.value)}function $(v,h){const E=i(v,h),x=v>0,W=B(h.name,E,x);return B(x?"past":"future",W,x)}function B(v,h,E){const x=s[v];return typeof x=="function"?x(h,E):x.replace("{0}",h.toString())}if(o<6e4&&!C)return s.justNow;if(typeof l=="number"&&o>l)return c(new Date(e));if(typeof l=="string"){const v=(n=m.find(h=>h.name===l))==null?void 0:n.max;if(v&&o>v)return c(new Date(e))}for(const[v,h]of m.entries()){if(i(u,h)<=0&&m[v-1])return $(u,m[v-1]);if(o<h.max)return $(u,h)}return s.invalid}const Pe={class:"text-h6"},ke={key:0},Re={class:"absolute-top-right q-ma-xs"},qe={class:"q-mb-md"},Qe={class:"text-caption q-ml-xs"},Ve={key:0},Be={class:"text-caption q-ml-xs"},He=te({__name:"DashboardParentCard",props:{showDescription:{type:Boolean},dashboardCard:null},setup(e){const{log:a}=ne(),{goToInspect:t,goToEdit:n,goToCharts:l}=ve(),{confirmDialog:s,dismissDialog:c}=me();async function m(u){c("Previous Note",u,y.NOTE,"info")}async function C(u,o,i){s("Favorite",`Do you want to favorite ${i}?`,y.FAVORITE_ON,"info",async()=>{try{await P.updateRecord(u,o,{favorited:!0}),a.info(`${i} favorited`,{type:u,id:o,name:i})}catch($){a.error("Favorite update failed",$)}})}async function g(u,o,i){s("Unfavorite",`Do you want to unfavorite ${i}?`,y.FAVORITE_OFF,"info",async()=>{try{await P.updateRecord(u,o,{favorited:!1}),a.info(`${i} unfavorited`,{type:u,id:o,name:i})}catch($){a.error("Unfavorite update failed",$)}})}async function b(u,o,i){s("Delete",`Permanently delete ${i}? This will also delete any underlying child records.`,y.DELETE,"negative",async()=>{try{await P.deleteRecord(u,o),a.info(`${i} and grouped records deleted`,{type:u,id:o,name:i})}catch($){a.error("Delete failed",$)}})}return(u,o)=>(I(),oe(de,null,{default:d(()=>[r(re,null,{default:d(()=>[D("p",Pe,O(e.dashboardCard.name),1),e.showDescription?(I(),_("p",ke,O(e.dashboardCard.desc),1)):L("",!0),D("div",Re,[A(r(w,{name:f(y).NOTE,color:"primary",size:"md",class:"cursor-pointer q-mr-xs",onClick:o[0]||(o[0]=i=>m(e.dashboardCard.previousNote||""))},null,8,["name"]),[[N,e.dashboardCard.previousNote]]),A(r(w,{name:f(y).FAVORITE_ON,color:"warning",size:"md",class:"cursor-pointer",onClick:o[1]||(o[1]=i=>g(e.dashboardCard.type,e.dashboardCard.id,e.dashboardCard.name))},null,8,["name"]),[[N,e.dashboardCard.favorited]]),A(r(w,{name:f(y).FAVORITE_OFF,color:"grey",size:"md",class:"cursor-pointer",onClick:o[2]||(o[2]=i=>C(e.dashboardCard.type,e.dashboardCard.id,e.dashboardCard.name))},null,8,["name"]),[[N,!e.dashboardCard.favorited]]),r(le,{round:"",flat:"",icon:f(y).MENU_VERTICAL},{default:d(()=>[r(fe,{"auto-close":"",anchor:"top right","transition-show":"flip-right","transition-hide":"flip-left"},{default:d(()=>[r(ce,null,{default:d(()=>[r(T,{clickable:"",onClick:o[3]||(o[3]=i=>f(t)(e.dashboardCard.type,e.dashboardCard.id))},{default:d(()=>[r(p,{avatar:""},{default:d(()=>[r(w,{color:"primary",name:f(y).INSPECT},null,8,["name"])]),_:1}),r(p,null,{default:d(()=>[S("Inspect")]),_:1})]),_:1}),r(T,{clickable:"",onClick:o[4]||(o[4]=i=>f(n)(e.dashboardCard.type,e.dashboardCard.id))},{default:d(()=>[r(p,{avatar:""},{default:d(()=>[r(w,{color:"primary",name:f(y).EDIT},null,8,["name"])]),_:1}),r(p,null,{default:d(()=>[S("Edit")]),_:1})]),_:1}),r(T,{clickable:"",onClick:o[5]||(o[5]=i=>f(l)(e.dashboardCard.type,e.dashboardCard.id))},{default:d(()=>[r(p,{avatar:""},{default:d(()=>[r(w,{color:"primary",name:f(y).CHARTS},null,8,["name"])]),_:1}),r(p,null,{default:d(()=>[S("Charts")]),_:1})]),_:1}),r(ie),r(T,{clickable:"",onClick:o[6]||(o[6]=i=>b(e.dashboardCard.type,e.dashboardCard.id,e.dashboardCard.name))},{default:d(()=>[r(p,{avatar:""},{default:d(()=>[r(w,{color:"negative",name:f(y).DELETE},null,8,["name"])]),_:1}),r(p,null,{default:d(()=>[S("Delete")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["icon"])]),D("div",qe,[r(he,{rounded:"",color:"secondary",class:"q-py-none"},{default:d(()=>[r(w,{name:f(y).PREVIOUS},null,8,["name"]),D("span",Qe,O(f(Ae)(e.dashboardCard.previousTimestamp||"").value||"No previous records"),1)]),_:1}),e.dashboardCard.previousTimestamp?(I(),_("div",Ve,[r(w,{name:f(y).CALENDAR_CHECK},null,8,["name"]),D("span",Be,O(f(se)(e.dashboardCard.previousTimestamp)),1)])):L("",!0)]),D("div",null,[ue(u.$slots,"default")])]),_:3})]),_:3}))}});export{He as _};
