import{d as E,u as A,A as I,a as R,D as b,r as V,L as k,a9 as $,aa as v,ab as x,o as B,c as o,e as y,w as d,h as a,j as u,f as s,Q,m as C,I as n,i as F,F as N,k as T,l as r,n as M,a6 as q,a7 as L,ac as j,b as W,ad as z}from"./index-8d0bb118.js";import{Q as U}from"./QForm-cce9c74f.js";import{_ as G}from"./ResponsivePage.vue_vue_type_script_setup_true_lang-53e79d88.js";import{_ as H}from"./ParentInfoCard.vue_vue_type_script_setup_true_lang-fc05a4a4.js";import{u as J}from"./useRoutables-6d5f8471.js";import{u as K}from"./action-ff137bd1.js";import{u as O}from"./useDialogs-0f49c300.js";import"./SimpleDialog.vue_vue_type_script_setup_true_lang-4e400aa1.js";const X={key:0},Y=r("span",{class:"q-ml-md"},"Error rendering this record",-1),Z={key:1},P={class:"row justify-start"},ee={class:"col"},ae={class:"col"},te=r("span",{class:"text-caption q-ml-xs text-warning"}," Correct invalid entries and try again ",-1),me=E({__name:"CreateView",setup(se){A({title:`${I} - Create Record`});const{routeType:i,routeParentId:p,goBack:D}=J(),{log:m}=R(),{confirmDialog:h}=O(),l=K(),_=b.getLabelSingular(i),g=b.getFieldProps(i),f=V(!0);k(async()=>{try{await $.isValid(p)&&(l.record[v.PARENT_ID]=p),l.record[v.ID]=x()}catch(t){m.error("Error loading create view",t)}}),B(()=>{l.$reset()});async function w(){h("Create",`Create ${_} record?`,n.CREATE,"positive",async()=>{try{const t=j(!0,{},l.record);await W.addRecord(i,t),m.info("Successfully created record",{id:t[v.ID],type:i}),D()}catch(t){m.error("Create failed",t)}})}return(t,c)=>(o(),y(G,{bannerIcon:a(n).CREATE,bannerTitle:`Create ${a(_)}`},{default:d(()=>[!a(_)||!a(g)?(o(),u("div",X,[s(F,{class:"q-mb-md"},{default:d(()=>[s(Q,null,{default:d(()=>[s(C,{name:a(n).WARN,size:"md",color:"warning"},null,8,["name"]),Y]),_:1})]),_:1})])):(o(),u("div",Z,[s(U,{onSubmit:w,onValidationError:c[0]||(c[0]=e=>f.value=!1),onValidationSuccess:c[1]||(c[1]=e=>f.value=!0)},{default:d(()=>[s(H),(o(!0),u(N,null,T(a(g),(e,S)=>(o(),u("div",{key:S,class:"q-mb-md"},[(o(),y(z(e.component),{field:e.field,label:e.label,desc:e.desc,getDefault:e.getDefault,validator:e.validator,validationMessage:e.validationMessage},null,8,["field","label","desc","getDefault","validator","validationMessage"]))]))),128)),r("div",P,[r("div",ee,[s(M,{label:"Create",type:"submit",color:"positive",icon:a(n).SAVE},null,8,["icon"])]),r("div",ae,[q(r("div",null,[s(C,{name:a(n).WARN,color:"warning"},null,8,["name"]),te],512),[[L,!f.value]])])])]),_:1})]))]),_:1},8,["bannerIcon","bannerTitle"]))}});export{me as default};
