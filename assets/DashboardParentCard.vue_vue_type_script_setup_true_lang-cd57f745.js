import{q as G,z as P,v as K,R as J,h as c,r as Q,aN as X,E as Y,aO as Z,aP as ee,aQ as ae,d as te,a as ne,c as F,e as oe,w as u,f as r,Q as re,l as x,t as E,j as _,a4 as L,a6 as I,m as w,I as y,a7 as A,n as le,a2 as O,a1 as ie,aR as se,aS as ue,i as de,D as N}from"./index-bcd0c63a.js";import{Q as S,a as $}from"./QItem-b53cd3c9.js";import{Q as ce}from"./QList-88ad3383.js";import{Q as fe}from"./QMenu-eb68067c.js";import{u as me}from"./useDialogs-a5eb05fb.js";import{u as ve}from"./useRoutables-8e2fcfd3.js";const ye=["top","middle","bottom"],ge=G({name:"QBadge",props:{color:String,textColor:String,floating:Boolean,transparent:Boolean,multiLine:Boolean,outline:Boolean,rounded:Boolean,label:[Number,String],align:{type:String,validator:e=>ye.includes(e)}},setup(e,{slots:a}){const t=P(()=>e.align!==void 0?{verticalAlign:e.align}:null),n=P(()=>{const l=e.outline===!0&&e.color||e.textColor;return`q-badge flex inline items-center no-wrap q-badge--${e.multiLine===!0?"multi":"single"}-line`+(e.outline===!0?" q-badge--outline":e.color!==void 0?` bg-${e.color}`:"")+(l!==void 0?` text-${l}`:"")+(e.floating===!0?" q-badge--floating":"")+(e.rounded===!0?" q-badge--rounded":"")+(e.transparent===!0?" q-badge--transparent":"")});return()=>K("div",{class:n.value,style:t.value,role:"status","aria-label":e.label},J(a.default,e.label!==void 0?[e.label]:[]))}});function k(e){return Z()?(ee(e),!0):!1}function q(e){return typeof e=="function"?e():c(e)}const R=typeof window<"u";function he(e,a=1e3,t={}){const{immediate:n=!0,immediateCallback:l=!1}=t;let i=null;const d=Q(!1);function f(){i&&(clearInterval(i),i=null)}function C(){d.value=!1,f()}function h(){const b=q(a);b<=0||(d.value=!0,l&&e(),f(),i=setInterval(e,b))}if(n&&R&&h(),X(a)||typeof a=="function"){const b=Y(a,()=>{d.value&&R&&h()});k(b)}return k(C),{isActive:d,pause:C,resume:h}}const be=R?window:void 0;function Ce(e,a={}){const{immediate:t=!0,window:n=be}=a,l=Q(!1);let i=0,d=null;function f(b){if(!l.value||!n)return;const s=b-i;e({delta:s,timestamp:b}),i=b,d=n.requestAnimationFrame(f)}function C(){!l.value&&n&&(l.value=!0,d=n.requestAnimationFrame(f))}function h(){l.value=!1,d!=null&&n&&(n.cancelAnimationFrame(d),d=null)}return t&&C(),k(h),{isActive:ae(l),pause:h,resume:C}}var we=Object.defineProperty,j=Object.getOwnPropertySymbols,$e=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable,M=(e,a,t)=>a in e?we(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,xe=(e,a)=>{for(var t in a||(a={}))$e.call(a,t)&&M(e,t,a[t]);if(j)for(var t of j(a))pe.call(a,t)&&M(e,t,a[t]);return e};function De(e={}){const{controls:a=!1,interval:t="requestAnimationFrame"}=e,n=Q(new Date),l=()=>n.value=new Date,i=t==="requestAnimationFrame"?Ce(l,{immediate:!0}):he(l,t,{immediate:!0});return a?xe({now:n},i):n}var Ee=Object.defineProperty,T=Object.getOwnPropertySymbols,z=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable,U=(e,a,t)=>a in e?Ee(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,Oe=(e,a)=>{for(var t in a||(a={}))z.call(a,t)&&U(e,t,a[t]);if(T)for(var t of T(a))H.call(a,t)&&U(e,t,a[t]);return e},Se=(e,a)=>{var t={};for(var n in e)z.call(e,n)&&a.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&T)for(var n of T(e))a.indexOf(n)<0&&H.call(e,n)&&(t[n]=e[n]);return t};const Te=[{max:6e4,value:1e3,name:"second"},{max:276e4,value:6e4,name:"minute"},{max:72e6,value:36e5,name:"hour"},{max:5184e5,value:864e5,name:"day"},{max:24192e5,value:6048e5,name:"week"},{max:28512e6,value:2592e6,name:"month"},{max:1/0,value:31536e6,name:"year"}],Fe={justNow:"just now",past:e=>e.match(/\d/)?`${e} ago`:e,future:e=>e.match(/\d/)?`in ${e}`:e,month:(e,a)=>e===1?a?"last month":"next month":`${e} month${e>1?"s":""}`,year:(e,a)=>e===1?a?"last year":"next year":`${e} year${e>1?"s":""}`,day:(e,a)=>e===1?a?"yesterday":"tomorrow":`${e} day${e>1?"s":""}`,week:(e,a)=>e===1?a?"last week":"next week":`${e} week${e>1?"s":""}`,hour:e=>`${e} hour${e>1?"s":""}`,minute:e=>`${e} minute${e>1?"s":""}`,second:e=>`${e} second${e>1?"s":""}`,invalid:""};function Ie(e){return e.toISOString().slice(0,10)}function Ae(e,a={}){const{controls:t=!1,updateInterval:n=3e4}=a,l=De({interval:n,controls:!0}),{now:i}=l,d=Se(l,["now"]),f=P(()=>Ne(new Date(q(e)),a,q(i.value)));return t?Oe({timeAgo:f},d):f}function Ne(e,a={},t=Date.now()){var n;const{max:l,messages:i=Fe,fullDateFormatter:d=Ie,units:f=Te,showSecond:C=!1,rounding:h="round"}=a,b=typeof h=="number"?v=>+v.toFixed(h):Math[h],s=+t-+e,o=Math.abs(s);function m(v,g){return b(Math.abs(v)/g.value)}function V(v,g){const D=m(v,g),p=v>0,W=B(g.name,D,p);return B(p?"past":"future",W,p)}function B(v,g,D){const p=i[v];return typeof p=="function"?p(g,D):p.replace("{0}",g.toString())}if(o<6e4&&!C)return i.justNow;if(typeof l=="number"&&o>l)return d(new Date(e));if(typeof l=="string"){const v=(n=f.find(g=>g.name===l))==null?void 0:n.max;if(v&&o>v)return d(new Date(e))}for(const[v,g]of f.entries()){if(m(s,g)<=0&&f[v-1])return V(s,f[v-1]);if(o<g.max)return V(s,g)}return i.invalid}const Pe={class:"text-h6"},ke={key:0},qe={class:"absolute-top-right q-ma-xs"},Re={class:"q-mb-md"},Qe={class:"text-caption q-ml-xs"},Ve={key:0},Be={class:"text-caption q-ml-xs"},He=te({__name:"DashboardParentCard",props:{showDescription:{type:Boolean},dashboardCard:null},setup(e){const{log:a}=ne(),{goToInspect:t,goToEdit:n,goToCharts:l}=ve(),{confirmDialog:i,dismissDialog:d}=me();async function f(s){d("Previous Note",s,y.NOTE,"info")}async function C(s,o){i("Favorite",`Do you want to favorite ${o}?`,y.FAVORITE_ON,"info",async()=>{try{await N.update(s,{favorited:!0}),a.info(`${o} favorited`,{uid:s,name:o})}catch(m){a.error("Favorite update failed",m)}})}async function h(s,o){i("Unfavorite",`Do you want to unfavorite ${o}?`,y.FAVORITE_OFF,"info",async()=>{try{await N.update(s,{favorited:!1}),a.info(`${o} unfavorited`,{uid:s,name:o})}catch(m){a.error("Unfavorite update failed",m)}})}async function b(s,o){i("Delete",`Permanently delete ${o}? This will also delete any underlying child records.`,y.DELETE,"negative",async()=>{try{await N.deleteRecord(s),a.info(`${o} and grouped records deleted`,{uid:s,name:o})}catch(m){a.error("Delete failed",m)}})}return(s,o)=>(F(),oe(de,null,{default:u(()=>[r(re,null,{default:u(()=>[x("p",Pe,E(e.dashboardCard.name),1),e.showDescription?(F(),_("p",ke,E(e.dashboardCard.desc),1)):L("",!0),x("div",qe,[I(r(w,{name:c(y).NOTE,color:"primary",size:"md",class:"cursor-pointer q-mr-xs",onClick:o[0]||(o[0]=m=>f(e.dashboardCard.previousNote||""))},null,8,["name"]),[[A,e.dashboardCard.previousNote]]),I(r(w,{name:c(y).FAVORITE_ON,color:"warning",size:"md",class:"cursor-pointer",onClick:o[1]||(o[1]=m=>h(e.dashboardCard.uid,e.dashboardCard.name))},null,8,["name"]),[[A,e.dashboardCard.favorited]]),I(r(w,{name:c(y).FAVORITE_OFF,color:"grey",size:"md",class:"cursor-pointer",onClick:o[2]||(o[2]=m=>C(e.dashboardCard.uid,e.dashboardCard.name))},null,8,["name"]),[[A,!e.dashboardCard.favorited]]),r(le,{round:"",flat:"",icon:c(y).MENU_VERTICAL},{default:u(()=>[r(fe,{"auto-close":"",anchor:"top right","transition-show":"flip-right","transition-hide":"flip-left"},{default:u(()=>[r(ce,null,{default:u(()=>[r(S,{clickable:"",onClick:o[3]||(o[3]=m=>c(t)(e.dashboardCard.type,e.dashboardCard.group,e.dashboardCard.uid))},{default:u(()=>[r($,{avatar:""},{default:u(()=>[r(w,{color:"primary",name:c(y).INSPECT},null,8,["name"])]),_:1}),r($,null,{default:u(()=>[O("Inspect")]),_:1})]),_:1}),r(S,{clickable:"",onClick:o[4]||(o[4]=m=>c(n)(e.dashboardCard.type,e.dashboardCard.group,e.dashboardCard.uid))},{default:u(()=>[r($,{avatar:""},{default:u(()=>[r(w,{color:"primary",name:c(y).EDIT},null,8,["name"])]),_:1}),r($,null,{default:u(()=>[O("Edit")]),_:1})]),_:1}),r(S,{clickable:"",onClick:o[5]||(o[5]=m=>c(l)(e.dashboardCard.type,e.dashboardCard.group,e.dashboardCard.uid))},{default:u(()=>[r($,{avatar:""},{default:u(()=>[r(w,{color:"primary",name:c(y).CHARTS},null,8,["name"])]),_:1}),r($,null,{default:u(()=>[O("Charts")]),_:1})]),_:1}),r(ie),r(S,{clickable:"",onClick:o[6]||(o[6]=m=>b(e.dashboardCard.uid,e.dashboardCard.name))},{default:u(()=>[r($,{avatar:""},{default:u(()=>[r(w,{color:"negative",name:c(y).DELETE},null,8,["name"])]),_:1}),r($,null,{default:u(()=>[O("Delete")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["icon"])]),x("div",Re,[r(ge,{rounded:"",color:"secondary",class:"q-py-none"},{default:u(()=>[r(w,{name:c(y).PREVIOUS},null,8,["name"]),x("span",Qe,E(c(Ae)(e.dashboardCard.previousTimestamp||"").value||"No previous records"),1)]),_:1}),e.dashboardCard.previousTimestamp?(F(),_("div",Ve,[r(w,{name:c(y).CALENDAR_CHECK},null,8,["name"]),x("span",Be,E(c(se)(e.dashboardCard.previousTimestamp)),1)])):L("",!0)]),x("div",null,[ue(s.$slots,"default")])]),_:3})]),_:3}))}});export{He as _};
